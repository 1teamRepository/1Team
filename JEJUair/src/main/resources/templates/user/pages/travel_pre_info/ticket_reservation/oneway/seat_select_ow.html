<html lang="ko" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org/">

<!--head-->
<div th:replace="/user/fragment/head :: head"></div>
<!--head 끝-->

<body id="bookingLayoutBody">

<!--appAlert-->
<div th:replace="/user/fragment/appAlert :: appAlert"></div>
<!--appAlert 끝-->

<!--header-->
<div th:replace="/user/fragment/header :: header"></div>
<!--header 끝-->
<!--    <script src="https://code.jquery.com/jquery-3.6.0.min.js"integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>-->


<div id="body">
    <script >
        console.log("================jsonparse=============")

        const passJson = JSON.parse(localStorage.getItem("passJson"))
        console.log(passJson);
        const tripJson = JSON.parse(localStorage.getItem("tripJson"))
        console.log(tripJson);
        const schIdx = Number(tripJson["schIdx"]);


        console.log("================jsonparse=============")

        let bizSeats = 0;
        let ecoSeats = 0;
    </script>

    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PD2BQQ4" height="0" width="0"
                style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div class="wrap wrap--booking NA NA_1_6" style="height: 2000px">

        <div class="content" id="content">
            <main id="main" class="main ">

                <form id="frmNext" name="frmNext" method="post">
                    <input type="hidden" id="pnrData" name="pnrData" value="">
                    <input type="hidden" id="rpnr" name="rpnr" value="">
                    <input type="hidden" id="payType" name="payType" value="">
                    <input type="hidden" id="bookType" name="bookType" value="">
                    <input type="hidden" id="tripType" name="tripType" value="">
                    <input type="hidden" id="inflType" name="inflType" value="">
                    <input type="hidden" id="domIntType" name="domIntType" value="">
                    <input type="hidden" id="cultureCode" name="cultureCode" value="">
                    <input type="hidden" id="seatData" name="seatData" value="">
                    <input type="hidden" id="saleTypeCd" name="saleTypeCd" value="">
                    <input type="hidden" id="productTypeCode" name="productTypeCode" value="">
                    <input type="hidden" id="GAProducts" name="GAProducts" value="">
                    <input type="hidden" id="originData" name="originData" value=""/>
                    <input type="hidden" id="selectedJourneys" name="selectedJourneys" value="">
                    <input type="hidden" id="exchangePnrData" name="exchangePnrData" value="">
                    <input type="hidden" id="totalPoint" name="totalPoint" value=""/>
                    <input type="hidden" id="resvDetailReq" name="resvDetailReq" value=""/>
                    <input type="hidden" id="isBizLiteClass" name="isBizLiteClass" value=""/>
                    <input type="hidden" id="bundleMaintain" name="bundleMaintain" value=""/>
                    <input type="hidden" id="ssrAgentId" name="ssrAgentId" value=""/>
                </form>


                <div id="sectionName" class="title__section-service">
                    가는 편
                    <!-- 가는 편 -->
                    <div id="divTrip" class="trip" style="display: none">
                        <span class="from"></span>
                        <span class="mark oneway" aria-label="oneway"></span>
                        <span class="to"></span>
                    </div>
                </div>

                <div class="sub-box">

                    <div class="tab tab--scroll tab--icon tab--seat tab__scroll line2" data-element="tab"
                         data-options='{"tabType": "scroll"}'>


                        <div class="sticky-wrap">
                            <div class="sticky__inner pc-large" data-sticky>
                                <div class="tab__inner">
                                    <div id="divArrow" style="display: none">
                                        <button id="btnLeft" class="button tab__scroll-left"
                                                data-tab-direction="prev" onclick="btnArrowClick(this);">
                                            <span class="hidden">왼쪽 탭으로 이동</span>
                                        </button>
                                        <button id="btnRight" class="button tab__scroll-right"
                                                data-tab-direction="next" onclick="btnArrowClick(this);">
                                            <span class="hidden">오른쪽 탭으로 이동</span>
                                        </button>
                                    </div>
                                    <div class="tab__scroll-wrap tab__scroll-wrap--full"
                                         data-element="tab__scroll-wrap">
                                        <div id="divMember" class="tab__buttons" data-element="tab__scroll"></div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="tab__panel tab__panel--no-pat is-active">


                            <div class="select-seat js-seat-value narrow">
                                <div id="divSeatMap" class="select-seat__map" data-seat-map="">


                                    <div id="divBusinessLite" style="display: none">
                                        <h3 class="select-seat__title">

                                            <span>비즈니스 라이트</span>
                                        </h3>
                                        <div class="select-seat__premium">
                                            <div class="select-seat__columns">
                                                <div class="column bizseat" data-column="A">
                                                    <strong class="row-name">A</strong>
                                                </div>
                                                <div class="column bizseat" data-column="B" style="display: none">
                                                    <strong class="row-name">B</strong>
                                                </div>
                                                <div class="column bizseat" data-column="C">
                                                    <strong class="row-name">C</strong>
                                                </div>

                                                <div class="column column--numbers--premium"></div>

                                                <div class="column bizseat" data-column="D">
                                                    <strong class="row-name">D</strong>
                                                </div>
                                                <div class="column bizseat" data-column="E" style="display: none">
                                                    <strong class="row-name">E</strong>
                                                </div>
                                                <div class="column bizseat" data-column="F">
                                                    <strong class="row-name">F</strong>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <h3 class="select-seat__title">이코노미</h3><!-- 이코노미 -->
                                    <div class="select-seat__economy">
                                        <div class="select-seat__columns">
                                            <div class="column economyseat1" data-column="A">
                                                <strong class="row-name">A</strong>
                                            </div>
                                            <div class="column economyseat1" data-column="B">
                                                <strong class="row-name">B</strong>
                                            </div>

                                            <div class="column economyseat1" data-column="C">
                                                <strong class="row-name">C</strong>
                                            </div>

                                            <div class="column column--numbers econum1"></div>

                                            <div class="column economyseat1" data-column="D">
                                                <strong class="row-name">D</strong>
                                            </div>
                                            <div class="column economyseat1" data-column="E">
                                                <strong class="row-name">E</strong>
                                            </div>
                                            <div class="column economyseat1" data-column="F">
                                                <strong class="row-name">F</strong>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="select-seat__exit">
                                        <span class="exit">EXIT</span> <span class="exit">EXIT</span>
                                    </div>


                                    <div class="select-seat__economy">
                                        <div class="select-seat__columns">
                                            <div class="column economyseat2" data-column="A"></div>
                                            <div class="column economyseat2" data-column="B"></div>
                                            <div class="column economyseat2" data-column="C"></div>

                                            <div class="column column--numbers econum2"></div>

                                            <div class="column economyseat2" data-column="D"></div>
                                            <div class="column economyseat2" data-column="E"></div>
                                            <div class="column economyseat2" data-column="F"></div>
                                        </div>
                                    </div>

                                    <div class="select-seat__exit">
                                        <span class="exit">EXIT</span> <span class="exit">EXIT</span>
                                    </div>


                                    <div class="select-seat__economy">
                                        <div class="select-seat__columns">
                                            <div class="column economyseat3" data-column="A"></div>
                                            <div class="column economyseat3" data-column="B"></div>
                                            <div class="column economyseat3" data-column="C"></div>

                                            <div class="column column--numbers econum3"></div>

                                            <div class="column economyseat3" data-column="D"></div>
                                            <div class="column economyseat3" data-column="E"></div>
                                            <div class="column economyseat3" data-column="F"></div>
                                        </div>
                                    </div>

                                    <div class="seat-nav">
                                        <div class="seat-img">
                                            <img src="https://static.jejuair.net/hpgg/resources/images/seat/seat_exam01.png"
                                                 alt="" aria-hidden="true">
                                            <div class="seat-pos" style="background-image: url(https://static.jejuair.net/hpgg/resources/images/seat/seat_exam01.png);
                                                        height: 100%">
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section-wrap">
                    <div class="service-information">
                        <div class="service-information__title"></div>
                    </div>
                </div>

                <div id="divBottomSheet" class="booking-sticky booking-sticky--reservation" data-element="toggle"
                     data-options='{"mode": "slide"}'>
                    <div class="reservation-container">
                        <div class="booking-sticky__top">
                            <div class="toggle-wrap toggle-wrap--button" style="display: flex; align-items: center">
                                <div class="label" style="display: flex; align-items: center">
                                    <span>예상 결제금액</span>
                                </div>

                                <button id="btnSummary" type="button" class="summary" data-element="toggle__anchor">
                                    <span id="spanCost" class="cost">
                                        <span class="price_txt flight__cost"></span>
                                        <span class="unit">원</span>
                                    </span>
                                </button>
                            </div>

                            <button type="button" class="button button--primary button--black pc-only"
                                    id="btnPrevPC" style="display: none">
                                <span class="button__text">이전</span><!-- 이전 -->
                            </button>

                            <button type="button" class="button button--primary pc-only button--active pc-only"
                                    id="btnNextPC">
                                    <span id="spanNextPC" class="button__text"><a>다음</a></span>
                            </button>
                        </div>

                        <div class="booking-sticky__bottom line -limitH" data-element="toggle__panel">
                            <div class="title">
                                <h3 class="title__section title__section--small">항목별 운임 상세</h3><!-- 항목별 운임 상세 -->
                            </div>
                            <h4 class="text__default text--bold">항공 운송료</h4><!-- 항공 운송료 -->
                            <div id="airFreightCharges" class="itemize__item">
                                <div id="divFare" class="flex-text">
                                    <div class="flex-text__title">항공운임</div>
                                    <div class="flex-text__additional">
                                        <span class="price_txt flight__cost"></span>
                                        <span class="unit">원</span>
                                    </div>
                                </div>
                                <div id="divTax" class="flex-text">
                                    <div class="flex-text__title">공항시설 사용료</div>
                                    <div class="flex-text__additional">
                                        <span class="price_txt flight__cost"></span>
                                        <span class="unit">원</span>
                                    </div>
                                </div>
                                <div id="divFuel" class="flex-text">
                                    <div class="flex-text__title">유류할증료</div>
                                    <div class="flex-text__additional">
                                        <span class="price_txt flight__cost"></span>
                                        <span class="unit">원</span>
                                    </div>
                                </div>
                            </div>

                            <div id="extraServiceFee" class="conatinaer--default pc-20" style="display: none">
                                <h4 class="text__default text--bold">부가서비스</h4><!-- 부가서비스 -->
                                <div class="itemize__item">
                                    <div class="flex-text" id="divSeat">
                                        <div class="flex-text__title">좌석 선택</div><!-- 좌석 선택 -->
                                        <div class="flex-text__additional" id="divSeatFee">
                                            <span class="price_txt flight__cost"></span>
                                            <span class="unit">원</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="button-wrap mobile-only">
                            <button type="button" class="button button--primary button--black" id="btnPrevMobile"
                                    style="display: none">
                                <span class="button__text">이전</span><!-- 이전 -->
                            </button>

                            <button type="button" class="button button--primary button--active" id="btnNextMobile">
                                    <span id="spanNextMobile" class="button__text"><a
                                            href="../seat_select/seat_select.html">오는 편 좌석 선택하기</a></span>
                                <!-- 오는 편 좌석 선택하기 -->
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>


        <!--좌석선택 건너뛰기-->

        <div id="divSkip" class="skip-wrap seat_skip is-active" style="display: none">
            <div class="skip-box">
                <p class="skip__text">다음에 구매할게요!</p><!-- 다음에 구매할게요! -->
                <a href="javascript:void(0)" class="skip__link" onclick="btnSkip_Click();">건너뛰기</a><!-- 건너뛰기 -->
            </div>
        </div>

        <!--//좌석선택 건너뛰기-->


        <!-- 추가 요금 좌석 선택 팝업 -->
        <div id="addChargeSeatLayer" class="modal modal-full modal-scroll modal--fixed-multi"
             style="display: none;">
            <div class="modal-header">
                <div class="modal-header__title">이 좌석을 선택하시겠어요?</div><!-- 이 좌석을 선택하시겠어요? -->
            </div>
            <div class="modal-content">
                <div class="select-seat select-seat--layer seat-align mt0">
                    <div class="select-seat__tag">
                        <i id="seatNo" class="select-seat__seat"></i>
                        <span class="select-seat__tag-price">더 넓고 안락해요.</span><!-- 더 넓고 안락해요 -->
                    </div>
                </div>

                <div id="divSelectText" class="select-text small mt-15"></div>
            </div>
            <div class="fixed-wrap fixed-wrap--multi-line border-none ">
                <div class="button-wrap pc-center">
                    <button type="button" class="button button--primary button--black width_155"
                            onclick="$.modal.close();">
                        <span class="button__text">다른 좌석 선택</span><!-- 다른 좌석 선택 -->
                    </button>
                    <button type="button" class="button button--primary button--active width_155"
                            onclick="btnSelect_Click();">
                        <span class="button__text">선택</span><!-- 선택 -->
                    </button>
                </div>
            </div>
            <a href="javascript:void(0)" rel="modal:close" class="modal__close"><span class="blind">닫기</span></a>
        </div>

        <!-- 좌석 선택화면 진입시 안내 팝업 S -->
        <div id="modalSeatCheck" class="modal modal--simple">
            <div class="modal-header">
                <div class="alert-title" text="원하시는 좌석을 미리 선택하세요">원하시는 좌석을 미리 <br>선택하세요
                </div>
            </div>
            <!-- 컨텐츠 시작 타이틀 추가 -->
            <div class="modal-content">
                <h2 class="alert-text" text="선호하시는 좌석을 유료로 구매하시고출발 당일 수속 시간을 절약하세요">선호하시는 좌석을 유료로 구매하시고 출발 당일 수속 시간을
                    절약하세요</h2>
                <p class="alert-text mt20 color--org"
                   text="사전에 좌석을 미리 예약하지 않으시면 탑승 당일 상황에 따라 랜덤으로 좌석이 배정되며 동반 승객과 떨어진 좌석이 제공될 수 있습니다.">사전에 좌석을 미리
                    예약하지 않으시면 탑승 당일 상황에 따라 랜덤으로 좌석이 배정되며 동반 승객과 떨어진 좌석이 제공될 수 있습니다.</p>
                <p class="alert-text mt20"
                   text="지금 좌석을 선택하지 않으셔도 예약후 마이페이지를 통해 유료 좌석 구매가 가능하고, 탑승 24시간 전 부터 모바일 탑승권 발급시 무료 좌석 선택이 가능합니다.">
                    지금 좌석을 선택하지 않으셔도 예약후 마이페이지를 통해 유료 좌석 구매가 가능하고, 탑승 24시간 전 부터 모바일 탑승권 발급시 무료 좌석 선택이 가능합니다.</p>
            </div>
            <!-- 컨텐츠 끝 -->
            <div class="modal__button-area button-wrap">
                <button type="button" class="button button--secondary" onclick="btnSkip_Click();">
                    <span class="button__text">건너뛰기</span> <!-- 건너뛰기 -->
                </button>
                <button type="button" class="button button--secondary button--active"
                        onclick="closeCurrentModal(this)">
                    <span class="button__text">확인</span>
                </button>
                <!-- button 활성화 시 button--active class 추가 -->
            </div>
            <a href="javascript:void(0)" onclick="closeCurrentModal(this)" class="modal__close"><span
                    class="blind">닫기</span></a>
        </div>
        <!-- 좌석 선택화면 진입시 안내 팝업 E -->

        <!-- 비상구 좌석 안내 팝업 -->
        <div id="exitSeatInfoLayer" class="modal modal-full modal--fixed-multi modal-scroll NA_1_63"></div>
        <!-- 제휴카드 할인 레이어 -->
        <div id="partnerCardDiscountLayer" class="modal modal-full modal-scroll NA_1_31"></div>

        <button type="button" id="btnModalOpen" data-element="modal_anchor" style="display: none;"></button>

        <a href="javascript:void(0)" id="sameSeatInfo" data-target-open="sameSeatsheet" style="display: none">
            가는 편과 같은 좌석 선택 바텀시트
        </a>

        <!-- alert 팝업 -->
        <div id="divAlertModalLayer" name="divAlert" class="modal modal--simple">
            <div class="modal-content">
                <p id="alertText" class="alert-text"></p>
            </div>
            <div class="modal__button-area button-wrap">
                <button id="btnAlert" type="button" class="button button--secondary button--active"
                        rel="modal:close" onclick="javascript:closeCurrentModal(this);"><span
                        class="button__text">확인</span></button>
            </div><!-- 확인 -->
        </div>
        <div style="display: none;"><a href="#" data-element="modal_anchor" id="sessionLayer"
                                       data-target="#sessionLayerForm" data-modal-type="default"></a></div>

        <div id="sessionLayerForm" class="modal modal--simple modal-layer NA_1_23"></div>
        </main>
    </div>
</div>


<!-- footer -->
<div th:replace="/user/fragment/footer :: footer"></div>
<!-- / footer 끝 -->


<!-- 가는 편과 같은 좌석 추천 팝업 -->
<div data-target="sameSeatsheet" class="bottom-sheet modal-full NA_1_71" data-element="bottomSheet">
    <div class="bottom-sheet__top">
        <div class="title">
            <h2 class="title__main">


                가는 편과 같은 좌석이 있어요! <br class="mobile-only">선택하시겠어요?
                <!-- 가는 편과 같은 좌석이 있어요! 선택 하시겠어요? -->


            </h2>
        </div>
    </div>
    <div class="bottom-sheet__bot">
        <p id="pMTText" class="text__default"></p>
        <div class="container--small pc-20">
            <div id="divSameSeat" class="select-seat select-seat--layer"></div>
        </div>
    </div>
    <div class="button-wrap button-wrap-stick pc-center pc-10">
        <button type="button" class="button button--primary button--black half" onclick="layerClose();">
            <span class="button__text">다른 좌석 선택</span> <!-- 다른 좌석 선택 -->
        </button>
        <button type="button" class="button button--primary button--active half" onclick="btnSameSeat_Click();">
            <span class="button__text">선택</span> <!-- 선택 -->
        </button>
    </div>
    <button id="btnSameClose" type="button" class="bottom-sheet__button-close"
            data-element="bottomSheet__button-close" aria-label="하단시트 닫기"></button>
</div>

<div id="ifmWrap"
     style="height:100%; display:none; overflow:auto; text-align:center; -webkit-overflow-scrolling:touch;">
    <iframe src="" width="100%" height="100%" name="popupChkApp"></iframe>
</div>

<!-- 공통 스크립트 선언 -->
<script type="text/javascript" src="/user/lib/js/lib.min.js"></script>
<script type="text/javascript" src="/user/lib/js/common.js"></script>
<script type="text/javascript" src="/user/lib/js/plugin.js"></script>

<script>
    // 승객 수
    let passengerNum = Number(tripJson["schPassengerNum"]);
    const divFare = Number(tripJson["divFare"]);
    const divTax = Number(tripJson["divTax"]);
    const divFuel = Number(tripJson["divFuel"]);
    let seatValue = tripJson["seatValue"];
    let bizO = "";
    let bizX = document.getElementById("divBusinessLite");

    let passengerNames = []
    for (let i = 0; i < passengerNum; i++) {
        passengerNames[i] = passJson["passLastName"+i]+passJson["passFirstName"+i]
        console.log(passengerNames[i])
    }


    if (seatValue == "biz") {
        bizX.style.display = "block";
        bizO = "disabled";
    }

    const ColArr = ['A', 'B', 'C', 'D', 'E', 'F'];

    let bizSeatMapHTML = "";
    let bizSeatLineHTML = "";
    let bizEmptyHTML = "";
    let bizSeatLineNum = 1;

    let ecoSeatMapHTML = "";
    let ecoSeatLineHTML = "";
    let ecoEmptyHTML = "";
    let ecoSeatLineNum = 1;

    let ecoPrice = 5000;
    let bizPrice = 10000;

    $('#divFare').find('.flight__cost')[0].innerHTML = divFare;
    $('#divTax').find('.flight__cost')[0].innerHTML = divTax;
    $('#divFuel').find('.flight__cost')[0].innerHTML = divFuel;
    $('#spanCost').find('.flight__cost')[0].innerHTML =  Number(divFare) + Number(divTax) + Number(divFuel);


    $.get("/api/flight_schedule/"+schIdx, function(response){
        let schRead = response.data;
        console.log(schRead);
        console.log("tbAircraftAcftIdx : " + schRead["tbAircraftAcftIdx"]);
        console.log("acftBizLiteSeats :" + schRead["acftBizLiteSeats"]);
        console.log("acftBizLiteSeats : "+schRead["acftNomalSeats"]);
        bizSeats = Number(schRead["acftBizLiteSeats"]);
        ecoSeats = Number(schRead["acftNomalSeats"]);


        for (let i = 0; i < bizSeats + 2*(bizSeatLineNum-1); i++) {
            const designator = i % 6 == 0 ? "BIZ" + bizSeatLineNum + ColArr[i % 6] : "BIZ" + (bizSeatLineNum - 1) + ColArr[i % 6];
            bizSeatMapHTML = '<button type="button" class="select-seat__seat seat-challenger" data-seat="" designator="' + designator + '" passenger-num=""><span class="selected"></span></button>';
            bizEmptyHTML = '<button type="button" class="select-seat__seat" data-seat="" designator="' + designator + '"></button>'
            bizSeatLineHTML = '<div class="number-wrap"><span class="number"><span data-seat="row">' + bizSeatLineNum + '</span></span></div>'

            let dataColumn = $('.bizseat')[i % 6];
            $(dataColumn).append(bizSeatMapHTML);
            if (i % 6 == 0) {
                $('.column--numbers--premium').append(bizSeatLineHTML);
                bizSeatLineNum++;
            }
        }

        for (let i = 0; i < ecoSeats + 3; i++) {
            const designator = i % 6 == 0 ? ecoSeatLineNum + ColArr[i % 6] : (ecoSeatLineNum - 1) + ColArr[i % 6];
            ecoSeatMapHTML = '<button type="button" ' + bizO + ' class="select-seat__seat seat-master" data-seat="" designator="' + designator + '" passenger-num=""><span class="selected"></span></button>';
            ecoEmptyHTML = '<div data-seat="name" designator="' + designator + '" style="height: 38px; width: 36px; margin-top: 16px"></div>'
            ecoSeatLineHTML = '<div class="number-wrap"><span class="number"><span data-seat="row">' + ecoSeatLineNum + '</span></span></div>'
            //클래스 column을 선택자로, attr로 data-column을 지정

            if (i >= 3 && i < 6) {
                let dataColumn = $('.economyseat1')[i % 6];
                $(dataColumn).append(ecoEmptyHTML);
            } else if (i < 78) {
                let dataColumn = $('.economyseat1')[i % 6];
                $(dataColumn).append(ecoSeatMapHTML);
                if (i % 6 == 0) {
                    $('.econum1').append(ecoSeatLineHTML);
                    ecoSeatLineNum++;
                }
            } else if (i < 84) {
                let dataColumn = $('.economyseat2')[i % 6];
                $(dataColumn).append(ecoSeatMapHTML);
                if (i % 6 == 0) {
                    $('.econum2').append(ecoSeatLineHTML);
                    ecoSeatLineNum++;
                }
            } else {
                let dataColumn = $('.economyseat3')[i % 6];
                $(dataColumn).append(ecoSeatMapHTML);
                if (i % 6 == 0) {
                    $('.econum3').append(ecoSeatLineHTML);
                    ecoSeatLineNum++;
                }
            }
        }

    });


    $(document).on('click', '.select-seat__seat', function () {
        selectSeat(this);
    });

    function selectSeat(select) {
        console.log(select);
        let activePassenger = document.querySelector("#divMember>.tab__button>.is-active");

        if ($(select).hasClass('selected') && $(select).attr("data-seat")) {
            if ($(select).attr("data-seat") === document.querySelector(".is-active>.passenger>.name").innerHTML &&
                select.firstChild.innerHTML === document.querySelector(".is-active>.passenger>.num").innerHTML) {
                $(activePassenger).attr("select-seat", "");
                document.querySelector(".is-active>.passenger>.seat").innerHTML = "";
                select.classList.remove('selected');
                select.classList.remove('on');
                select.classList.remove('selectPrice');
                $(select).attr("data-seat", "");
                select.firstChild.innerHTML = "";
            }
        } else {
            if ($(activePassenger).attr("select-seat") === "" && $(select).attr("data-seat") === "") {
                console.log(typeof ($(select).attr('data-seat')));
                $(activePassenger).attr("select-seat", $(select).attr("designator"));
                document.querySelector(".is-active>.passenger>.seat").innerHTML = $(select).attr("designator");
                select.classList.add('selected');
                select.classList.add('on');
                select.classList.add('selectPrice');
                $(select).attr("data-seat", document.querySelector(".is-active>.passenger>.name").innerHTML);
                select.firstChild.innerHTML = document.querySelector(".is-active>.passenger>.num").innerHTML;
            }
        }
        let selectPrice = $('.selectPrice');
        let ecoSelected = 0;
        let bizSelected = 0;

        for (let i = 0; i < selectPrice.length; i++) {
            if ($(selectPrice[i]).hasClass('seat-master')) {
                ecoSelected++;
            } else if ($(selectPrice[i]).hasClass('seat-challenger')) {
                bizSelected++;
            }
        }
        let totalSeatPrice = ecoSelected * ecoPrice + bizSelected * bizPrice;

        $('#spanCost').find('.flight__cost')[0].innerHTML =  Number(divFare) + Number(divTax) + Number(divFuel) + totalSeatPrice;
        $('#divSeat').find('.flight__cost')[0].innerHTML = totalSeatPrice;

        if (ecoSelected + bizSelected != 0) {
            document.getElementById('extraServiceFee').style.display = "block";
        } else {
            document.getElementById('extraServiceFee').style.display = "none";
        }
    }

    for (let i = 0; i < passengerNum; i++) {
        let passengerHTML = '<div class="tab__button" data-element="tab__list" role="presentation"><button class="tab__anchor" type="button" data-element="tab__anchor" onclick="btnMember_Click(this);" data-index="' + i + '" id="passenger"' + i + 'role="tab" tabindex="" select-seat="" aria-selected="true" aria-expanded="true"><span class="passenger"><span class="num">' + (i + 1) + '</span><strong class="name"> ' + passengerNames[i] + '  </strong><span name="passengerTypeCode" style="display: none">ADT</span> <span name="passengerKey" style="display: none" value="' + i + '"></span><span name="unitKey" style="display: none"></span><span name="seat" class="seat selected_seat" ></span><span name="variant" style="display: none"></span></span></button></div>'
        $('#divMember').append(passengerHTML);
    }

    window.onscroll = function () {
        scrollFunction()
    };

    function scrollFunction() {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            document.getElementsByClassName('seat-nav')[0].classList.add("on");
        } else {
            document.getElementsByClassName('seat-nav')[0].classList.remove("on");
        }
    }


    $(document).on('click', '#btnNextPC', function () {

        for (let i = 0; i < Number(tripJson["schPassengerNum"]); i++) {
            console.log(document.querySelectorAll(".selected_seat")[i]);
            passJson["pasSeat"+i] = document.querySelectorAll(".selected_seat")[i].innerHTML;
            console.log(document.querySelectorAll(".selected_seat")[i].innerHTML);
        }

        tripJson["divSeat"] = Number($('#divSeat').find('.flight__cost')[0].innerHTML);
        tripJson["spanCost"] = tripJson["divSeat"]+divFare + divTax + divFuel;
        localStorage.setItem("passJson", JSON.stringify(passJson));
        localStorage.setItem("tripJson", JSON.stringify(tripJson));
        location.href="/user/oneway/baggage_select";
    })


</script>
<style>
    .column--numbers--premium .number-wrap {
        height: 48px;
        margin-top: 16px;
    }

    .column--numbers--premium {
        margin-top: 30px;
    }
</style>


</body>

</html>